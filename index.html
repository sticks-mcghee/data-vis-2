<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flexbox Layout with Vega-Lite Graph</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f9fc;
        }

        .container {
            display: flex;
            flex-direction: column; /* Stack elements vertically */
            gap: 10px; /* Space between items */
            padding: 20px;
        }

        .header {
            background-color: #5378a1;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .row {
            display: flex; /* Create a flex container for each row */
            gap: 10px; /* Space between items in the row */
        }

        .text {
        font-size: 15px; /* Adjust as necessary */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: justify; /* Text will be justified within the container */
        height: 100%; /* Take the full height of the box */
        width: 100%;  /* Take the full width of the box */
        line-height: 1.5; /* Adjust for better spacing between lines */
        padding: 20px;
        }

        .box {
            background-color: #ffffff;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            overflow: hidden; /* To contain large content */
            flex: 1 auto; /* Allow boxes to grow equally */
        }

        .box_text {
            background-color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            overflow: hidden; /* To contain large content */
            flex: 1 auto; /* Allow boxes to grow equally */
            width: 40%;
        }


    
        .footer {
            background-color: #5378a1;
            color: white;
            text-align: center;
            padding: 20px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .row {
                flex-direction: column; /* Stack boxes vertically on small screens */
            }
        }
    </style>
    <!-- Vega-Lite libraries -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.1"></script>
</head>
<body>

<div class="container">
    <!-- Full width header -->
    <div class="header">
        <h1>Air Quality and Air Pollution Worldwide</h1>
    </div>

    <!-- Row 1 -->
    <div class="row">
        <div class="box">
            <div id="vis"></div>
        </div>
        <div class ='box_text'> 
            <div class ='text'>
            <p>The Air Quality Index (AQI) is a standardized system used to measure and communicate the quality of the air in a specific location. It is based on the concentrations of key pollutants, including ground-level ozone, particulate matter (PM2.5 and PM10), carbon monoxide, sulfur dioxide, and nitrogen dioxide. The AQI provides an easy-to-understand scale ranging from 0 to 500, where lower values indicate good air quality, and higher values represent increasingly hazardous conditions. Typically, AQI is divided into six categories: good (0-50), moderate (51-100), unhealthy for sensitive groups (101-150), unhealthy (151-200), very unhealthy (201-300), and hazardous (301-500).<p\>
            </div>
        </div>
    </div>

    <!-- Row 2 -->
    <div class="row">
        <div class="box"><div id="vis3"></div></div>
        <div class="box"><div id="vis6"></div></div>
    </div>

    <!-- Row 2.5-->
     <div class="row">
        <div class ='box_text'> 
          <div class ='text'>
          <p>On the left, a bar chart highlights PM2.5 concentrations across six regions, including Africa, the Americas, South-East Asia, and Europe. PM2.5 refers to tiny particles in the air that can penetrate deep into the lungs, posing significant health risks. Notably, South-East Asia and the Eastern Mediterranean have the highest PM2.5 levels, over 35 µg/m³—far exceeding the World Health Organization’s safe limit of 10 µg/m³. Regions like these are experiencing rapid industrialization, leading to heightened pollution levels. Meanwhile, the Americas and the Western Pacific, including Australia, show relatively lower PM2.5 concentrations of 15-20 µg/m³. 

On the right, a scatterplot compares average AQI and CO AQI for various countries. Most countries fall in moderate AQI ranges, but a few face higher pollution levels, likely due to heavy industrial activities. Carbon monoxide, although invisible and odorless, poses severe health risks as it can lead to poisoning without notice.<p\>
          </div>
      </div>
    </div>

    <!-- Row 3 -->
    <div class="row">
        <div class="box_text">
          <div class ='text'>
          <p>The image illustrates global CO2 emissions trends from 1970 to 2021, focusing on key countries and the global total. Notably, China’s emissions have skyrocketed since the early 2000s, surpassing 10,000 Mt CO2/yr by 2021, reflecting its rapid industrialization and economic growth. Meanwhile, emissions from the United States, which were once much higher, have leveled off and even declined, thanks in part to cleaner energy practices and emissions policies. Similarly, the United Kingdom has seen a marked reduction, despite its history as the birthplace of the Industrial Revolution, now embracing renewables like wind and solar. Australia, Russia, and the UK show relatively flat emission patterns compared to China and the U.S.

            The bottom graph highlights the steady rise in global CO2 emissions, peaking near 40,000 Mt CO2/yr by 2021. This steady growth reflects increased energy consumption, particularly in developing nations, as industrialization and population growth drive emissions upwards. <p\>
          </div></div>
        <div class="box"><div id="vis4"></div></div>

    </div>

    <!-- Row 4 -->
    <div class="row">
        <div class="box"><div id="vis1"></div></div>
        <div class="box"><div id="vis5"></div></div>
    </div>

    <!-- Row 5 -->
    <div class="row">
      <div class="box_text">
        <div class ='text'>
        <p>Australia's air quality and energy consumption have changed significantly over recent decades, influenced by natural forces, industrialization, and growing environmental awareness. Air quality across the country varies by state, with the Northern Territory and Queensland showing higher AQI values, likely due to industrial activities like mining and seasonal events such as bushfires and dust storms. In contrast, Tasmania and Victoria have lower AQI levels, possibly due to fewer pollution sources and stricter air quality controls. The devastating 2019-2020 "Black Summer" bushfires severely impacted air quality nationwide, with some regions experiencing dangerously high AQI levels from widespread smoke.

Australia’s energy consumption is shaped by its vast natural resources. Historically, the country has relied heavily on fossil fuels, particularly coal, for electricity generation. The pie chart on "Australian Energy Consumption" highlights coal’s continued dominance, with gas and oil also playing key roles in heating, transport, and industry. Despite this, Australia has made significant progress toward renewable energy. The Renewable Energy Target (RET) has driven investments in solar, wind, and hydroelectric power, especially in states like South Australia. By 2020, Australia exceeded its RET, generating over 33,000 GWh of renewable energy annually, marking a transition toward cleaner energy sources while fossil fuels remain significant.<p\>
        </div></div> 
    </div>

    <!-- Full width footer -->
    <div class="footer">
        
    </div>
</div>

<!-- Vega-Lite Visualization Script -->
<script>
    const spec2 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Average Air Quality Index (AQI) by State",
    "fontSize": 16,
    "anchor": "center",
    "color": "#000000"
  },
  "width": 400,
  "height": 400,
  "data": {
    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/MWM_DataDownload_AirQuality.csv",
    "format": {
      "type": "csv"
    }
  },
  "transform": [
    {
      "fold": [
        "2017-18", "2018-19", "2019-20", "2020-21", "2021-22", "2022-23"
      ],
      "as": ["Year", "AQI"]
    },
    {
      "filter": {"selection": "yearSelector"}
    }
  ],
  "mark": {
    "type": "bar",
    "color": "#5378a1"  // Set a fixed color for the bars
  },
  "encoding": {
    "x": {
      "field": "Jurisdiction",
      "type": "nominal",
      "axis": {"labelAngle": 45}
    },
    "y": {
      "field": "AQI",
      "type": "quantitative",
      "aggregate": "mean"
    },
    "tooltip": [
      {"field": "Jurisdiction", "type": "nominal", "title": "Jurisdiction"},
      {"field": "Year", "type": "nominal", "title": "Year"},
      {"aggregate": "mean", "field": "AQI", "type": "quantitative", "title": "Average AQI"}
    ]
  },
  "selection": {
    "yearSelector": {
      "type": "single",
      "fields": ["Year"],
      "bind": {
        "input": "select",
        "options": ["2017-18", "2018-19", "2019-20", "2020-21", "2021-22", "2022-23"],
        "name": "Select Year:"
      },
      "init": {"Year": "2022-23"}
    }
  }
}

  
  
  

;

    vegaEmbed('#vis1', spec2).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

<script>
    const spec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 750,
        "height": 450,
        "title": {
            "text": "Global Air Quality Index (AQI)",
            "fontSize": 25,
            "anchor": "center",
            "color": "#000000"
        },
        "projection": {"type": "equalEarth"},
        "layer": [
            {
                "data": {
                    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/ne_1.json",
                    "format": {"type": "topojson", "feature": "ne_10m_admin_0_countries"}
                },
                "mark": {"type": "geoshape", "stroke": "black", "strokeWidth": 1, "fill": "grey"},
                "encoding": {
                    "tooltip": [
                        {"field": "properties.NAME", "type": "nominal", "title": "Country"},
                        {"field": "AQI Value", "type": "quantitative", "title": "AQI Value"}
                    ]
                }
            },
            {
                "data": {
                    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/ne_1.json",
                    "format": {"type": "topojson", "feature": "ne_10m_admin_0_countries"}
                },
                "mark": {"type": "geoshape", "stroke": "black"},
                "transform": [
                    {
                        "lookup": "properties.NAME",
                        "from": {
                            "data": {
                                "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/e96242165520fe25a1b9a6d0834a93466e59b663/pollution_fixed.csv",
                                "format": {"type": "csv"}
                            },
                            "key": "Country",
                            "fields": ["AQI Value"]
                        }
                    }
                ],
                "encoding": {
                    "color": {
                        "field": "AQI Value",
                        "type": "quantitative",
                        "scale": {"scheme": "reds"},
                        "title": "AQI Value"
                    },
                    "tooltip": [
                        {"field": "properties.NAME", "type": "nominal", "title": "Country"},
                        {"field": "AQI Value", "type": "quantitative", "title": "AQI Value"}
                    ]
                }
            },
            {
                "data": {
                    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/ne_1.json",
                    "format": {"type": "topojson", "feature": "ne_110m_graticules_30"}
                },
                "mark": {"type": "geoshape", "stroke": "gray", "strokeWidth": 1, "fill": null}
            }
        ]
    };

    vegaEmbed('#vis', spec).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

<script>
    const spec3 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Concentrations of Fine Particulate Matter (PM2.5)",
    "fontSize": 25,
    "anchor": "center",
    "fontWeight": "bold",
    "lineHeight": 1.2
  },
  "width": 300,
  "height": 300,
  "data": {
    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/data.csv",
    "format": {"type": "csv"}
  },
  "params": [
    {
      "name": "selectedYear",
      "value": 2010,
      "bind": {
        "input": "range",
        "min": 2010,
        "max": 2019,
        "step": 1,
        "name": "Year"
      }
    }
  ],
  "transform": [
    {
      "filter": "datum.Period == selectedYear"
    },
    {
      "aggregate": [{"op": "mean", "field": "FactValueNumeric", "as": "mean_FactValueNumeric"}],
      "groupby": ["ParentLocation"]
    }
  ],
  "mark": {
    "type": "bar",
    "color": "#5378a1"  // Set the bar color to grey
  },
  "encoding": {
    "x": {
      "field": "ParentLocation",
      "type": "nominal",
      "axis": {"title": "Regions", "labelAngle": 45}
    },
    "y": {
      "field": "mean_FactValueNumeric",
      "type": "quantitative",
      "axis": {"title": "Average PM2.5 Values"}
    },
    
    "tooltip": [
      {"field": "ParentLocation", "type": "nominal", "title": "Region"},
      {"value": "Year: ", "title": "Year"}, // Fixed value for Year label
      {"field": "mean_FactValueNumeric", "type": "quantitative", "title": "Average PM2.5", "format": ".2f"} // Show average with 2 decimal places
    ]
  }
}

;

    vegaEmbed('#vis3', spec3).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

<script>
    const spec4 = {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": {
      "text": "CO2 Emissions: Australia, UK, US, China, and Russia",
      "fontSize": 25,
      "anchor": "middle",
      "fontWeight": "bold",
      "lineHeight": 1.2
    },
    "width": 300,
    "height": 300,
    "data": {
      "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/EDGARv7.0_FT2021_fossil_CO2_booklet_2022.csv",
      "format": {"type": "csv"}
    },
    "transform": [
      {
        "fold": [
          "1970", "1971", "1972", "1973", "1974", "1975",
          "1976", "1977", "1978", "1979", "1980", "1981",
          "1982", "1983", "1984", "1985", "1986", "1987",
          "1988", "1989", "1990", "1991", "1992", "1993",
          "1994", "1995", "1996", "1997", "1998", "1999",
          "2000", "2001", "2002", "2003", "2004", "2005",
          "2006", "2007", "2008", "2009", "2010", "2011",
          "2012", "2013", "2014", "2015", "2016", "2017",
          "2018", "2019", "2020", "2021"
        ],
        "as": ["Year", "Value"]
      }
    ],
    "vconcat": [
      {
        "layer": [
          {
            "mark": "line",
            "params": [
              {
                "name": "brush",
                "select": {
                  "type": "interval",
                  "encodings": ["x"],
                  "init": [{"Year": 2000}, {"Year": 2021}]
                }
              }
            ],
            "transform": [
              {
                "filter": {
                  "field": "Country",
                  "oneOf": ["Australia", "United Kingdom", "United States", "China", "Russia"]
                }
              }
            ],
            "encoding": {
              "x": {
                "field": "Year",
                "type": "quantitative",
                "scale": {"domain": {"param": "brush"}},
                "axis": {"title": "Year","format": ""}
                
              },
              "y": {
                "field": "Value",
                "type": "quantitative",
                "axis": {
                  "title": "CO2 Emissions (Mt CO2/yr)",
                  "tickCount": 5,
                  "format": ".0f"
                }
              },
              "color": {
                "field": "Country",
                "type": "nominal",
                "legend": {"title": "Country"}
              },
              "tooltip": [
                {"field": "Country", "type": "nominal", "title": "Country"},
                {"field": "Year", "type": "quantitative", "title": "Year"},
                {"field": "Value", "type": "quantitative", "title": "CO2 Emissions (Mt CO2/yr)", "format": ".2f"}
              ]
            },
            "height": 300,
            "width": 450
          },
          {
            "mark": "text",
            "encode": {
              "enter": {
                "text": {"field": "Country"},
                "align": {"value": "left"},
                "baseline": {"value": "middle"},
                "dx": {"value": 5},
                "dy": {"value": -5}
              },
              "update": {
                "x": {
                  "field": "Year",
                  "scale": "x"
                },
                "y": {
                  "field": "Value",
                  "scale": "y"
                },
                "fill": {
                  "scale": "color",
                  "field": "Country"
                },
                "opacity": {"value": 1}
              },
              "hover": {
                "opacity": {"value": 0.7}
              }
            },
            "transform": [
              {
                "filter": {
                  "field": "Country",
                  "oneOf": ["Australia", "United Kingdom", "United States", "China", "Russia"]
                }
              }
            ]
          }
        ],
        "height": 300
      },
      {
        "mark": "area",
        "params": [{"name": "brush", "select": {"type": "interval", "encodings": ["x"]}}],
        "encoding": {
          "x": {
            "field": "Year",
            "type": "quantitative",
            "axis": {"title": "Year","format":""}
          },
          "y": {
            "field": "Value",
            "type": "quantitative",
            "axis": {
              "title": "Global CO2 Emissions (Mt CO2/yr)",
              "tickCount": 5,
              "format": ".0f"
            }
          },
          "color": {
            "field": "Country",
            "type": "nominal",
            "legend": {
              "title": "Country",
              "labelExpr": "datum.label === 'GLOBAL TOTAL' ? 'Global Total' : datum.label"
            }
          },
          "tooltip": [
            {"field": "Country", "type": "nominal", "title": "Country"},
            {"field": "Year", "type": "quantitative", "title": "Year"},
            {"field": "Value", "type": "quantitative", "title": "CO2 Emissions (Mt CO2/yr)", "format": ".2f"}
          ]
        },
        "transform": [
          {"filter": {"field": "Country", "equal": "GLOBAL TOTAL"}}
        ],
        "height": 150,
        "width": 450
      }
    ]
  }
  
  

;

    vegaEmbed('#vis4', spec4).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

<script>
    const spec5 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A simple pie chart with labels.",
  "title": {
    "text": "Australian Energy Consumption",
    "fontSize": 25,
    "fontWeight": "bold",
    "anchor": "middle"
  },
  "width": 500,
  "height": 500,
  "data": {
    "values": [
      {"category": "Coal", "value": 1525},
      {"category": "Oil", "value": 2285},
      {"category": "Gas", "value": 1518},
      {"category": "Renewables", "value": 553}
    ]
  },
  "encoding": {
    "theta": {"field": "value", "type": "quantitative", "stack": true},
    "color": {
      "field": "category",
      "type": "nominal",
      "scale": {
        "domain": ["Coal", "Oil", "Gas", "Renewables"],
        "range": ["#8c8c8c", "#d94e3d", "#d9b000", "#5e8c36"]
      },
      "legend": null
    }
  },
  "layer": [
    {
      "mark": {"type": "arc", "outerRadius": 120},
      "encoding": {
        "tooltip": [
          {"field": "category", "type": "nominal", "title": "Energy Source"},
          {
            "field": "value",
            "type": "quantitative",
            "title": "Consumption (Petajoules)",
            "format": ",.0f"
          }
        ]
      }
    },
    {
      "mark": {"type": "text", "radius": 140},
      "encoding": {
        "text": {"field": "category", "type": "nominal"},
        "tooltip": [
          {"field": "category", "type": "nominal", "title": "Energy Source"},
          {
            "field": "value",
            "type": "quantitative",
            "title": "Consumption (Petajoules)",
            "format": ",.0f"
          }
        ]
      }
    }
  ]
}




;

    vegaEmbed('#vis5', spec5).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

<script>
    const spec6 = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Average AQI vs. CO AQI by Country",
    "fontSize": 25,
    "anchor": "middle"
  },
  "width": 400,
  "height": 400,
  "data": {
    "url": "https://raw.githubusercontent.com/sticks-mcghee/data-vis-2/refs/heads/main/global%20air%20pollution%20dataset.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {
      "aggregate": [
        {"op": "average", "field": "AQI Value", "as": "Average AQI"},
        {"op": "average", "field": "CO AQI Value", "as": "Average CO AQI"}
      ],
      "groupby": ["Country"]
    },
    {
      "filter": "datum['Average AQI'] > 0 && datum['Average CO AQI'] > 0"
    }
  ],
  "mark": {
    "type": "point",
    "color": "#5378a1"
  },
  "encoding": {
    "x": {
      "field": "Average AQI",
      "type": "quantitative",
      "title": "Average AQI"
    },
    "y": {
      "field": "Average CO AQI",
      "type": "quantitative",
      "title": "Average CO AQI"
    },
    "tooltip": [
      {"field": "Country", "type": "nominal", "title": "Country"},
      {"field": "Average AQI", "type": "quantitative", "title": "Average AQI", "format": ".2f"},
      {"field": "Average CO AQI", "type": "quantitative", "title": "Average CO AQI", "format": ".2f"}
    ]
  }
}


;

    vegaEmbed('#vis6', spec6).then(result => {
        console.log(result);
    }).catch(console.error);
</script>

</body>
</html>
